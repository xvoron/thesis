% Artyom Voronin
%     _                     
% ___| |__  _ __  _ __ ___  
%/ __| '_ \| '_ \| '_ ` _ \ 
%\__ \ |_) | |_) | | | | | |
%|___/_.__/| .__/|_| |_| |_|
%          |_|              
%
% Brno, 2021

\documentclass[class=article, crop=false]{standalone}
\usepackage[subpreambles=true]{standalone}
\usepackage{subcaption}

\usepackage{sectsty}
\usepackage{graphicx}
\graphicspath{{img/}{../img/}{../../img/}}
\usepackage{listings}
\lstset{language=Matlab}
\usepackage{hyperref}
\usepackage{amsmath}
\usepackage{import}
\usepackage{subfiles}
\usepackage{caption}
\usepackage[utf8]{inputenc}
\usepackage[english]{babel}

%\usepackage[square, numbers]{natbib}
%\bibliographystyle{unsrtnat}
%\usepackage[nottoc]{tocbibind}

\topmargin=-0.45in
\evensidemargin=0in
\oddsidemargin=0in
\textwidth=6.5in
\textheight=9.0in
\headsep=0.25in

%\title{Preprocessing data from pneumatic actuator}
%\author{Artyom Voronin} 
%\date{}

\begin{document}
\tableofcontents

% ----------------------------------------------------------------------------- 

% ----------------------------------------------------------------------------- 

\section{Signal Based PM}
Signal-Based Predictive Maintenance.
\paragraph{General}
\paragraph{Workflow}


\subsection{Sensors}
Sensors comparison, cost.

\subsection{Data exploring}
Data has been collect from 8 types of sensors corresponding table
\ref{tab:measured_signals}:
\begin{table}[h]
    \centering
    \begin{tabular}{|c|c|}
        \hline
        Signal name                   &   Description       \\     
               \hline
           FlowExtrusin               &   Flow sensor       \\
           FlowContraction            &   Flow sensor       \\
           AirPressure                &   Pressure sensor   \\
           AccelerometerMoving\_axisY &   Accelerometer     \\
           AccelerometerMoving\_axisY &   Position encoder  \\
                                      &   Accelerometer     \\
                                      &   Temperature sensor\\
                                      &   Proximity sensor  \\
                                      &   Strain gauge      \\ 
                                      &   Microphones       \\ 
        \hline
    \end{tabular}
    \caption{Measured signals}
    \label{tab:measured_signals}
\end{table}

There are 660 measurements with different parameters system parameters
\ref{tab:params}.
\begin{table}[h]
    \centering
    \begin{tabular}{|c|c|}
        \hline
        Adjusting valve 1 &  \\
        Adjusting valve 2 &  \\
        \hline
    \end{tabular}
    \caption{Device parameters}
    \label{tab:params}
\end{table}

Dataset was divided to 5 main categories.


Data has been accumulated to ".mat" files.
Each file contains signals from sensors during 10 seconds measurements with
different pneumatic actuator configuration. Example results from one
experiment are represented in figures \ref{fig:data_exmp1},
\ref{fig:data_exmp2}. 


\subsection{Data management}
\paragraph{Data Ensembles}
Data files have been reshaped to Data Ensembles format used for Condition
monitoring purposes. This format allows processing data without copying the
whole dataset to memory at once but processes them one by one. In large datasets
it gives an option to manipulate with data without problems with allocated memory.

Divided to 3 datasets:
\begin{itemize}
    \item Train data
    \item Validation data
    \item Test data
\end{itemize}

\subsection{Preprocessing}
Measured signals require preprocessing concerning the preservation of the information
base. For smoothing data Moving Average function were used.
As an example, the figure \ref{fig:preprocess} is shown the "raw" and filtered signals.
The whole dataset of preprocessed data is relatively big. For
time-saving, parallel computing was used for all computationally
demanding parts of the code.



\subsection{FDI methods}

\subsubsection{Line checking}

We can use Proximity sensor time delay between input signal and upper
proximity sensor signal to evaluate if there is some fault.

Same with Position, if not reach some end position, there is a fault.

Flow sensor, check if the float mean value is under some threshold, there
is fault.


\subsection{Condition Indicators extraction}

For classification task purpose from the signals have been extracted
statistical features such as mean, median, peak to peak value, etc.
As a condition "FaultCode" variable
were used. This variable represent configuration of pneumatic actuator
during the measurement.

All calculated features were added to the dataset and were ranked by
Kruskal-Wallis ANOVA algorithm. Following table \ref{tab:feat} contain
5 first best features ranked for classification purpose.

Kruskal-Wallis is very suitable to ranking features before using PCA or
SVD.

\subsubsection{Microphones}
Cheap, good results, but maybe problems with real life integration (noise
from another machines).

\subsubsection{Encoder}
Good results, useful in simulations and compare results with Digital Twin.

\subsubsection{Proximity Sensors}
Very correlated features. Can not be used for classification. But suitable
to detect binary classification (Health, Failed).
Only statistical features,no Frequency domain.

\subsubsection{Flow Sensors}
Very expensive sensors. Not so good results.

\subsubsection{Air Pressure}
This sensor always used, to control pressure valve. But not good results.
Maybe in combination with another sensor.

\subsection{Classification Task}

The main goal of the classification task is to train a model that can
predict the "FaultCode", or "Label" signalized about pneumatic actuator behavior by
calculated features.

Using Kuskal-Wallis one way analysis of variance, features were ranked by
importance with respect to correlation. This gives opportunity to reduce
number of features before PCA analysis.

Principal component analysis (PCA) has been used to reduce the number of
features and chose the best representants.

The trained model has been exported to
\textbf{models/} directory.

The confusion matrix of the trained classification model shown in figure
\ref{fig:conf}. Model accuracy on validation data is $\approx 93 \%$
\ref{fig:pred}.


\end{document}
